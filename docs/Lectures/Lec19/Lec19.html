<!DOCTYPE html>
<html lang="en"><head>
<link href="../../Images/Logos_Icons/hex.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="Ethan P. Marzban">
  <title>PSTAT 100: Summer 2025 – PSTAT 100: Lecture 19</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-ce6bc8a5410e8df11883f060677c6af5.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {enableAssistiveMml: false}});</script>
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="Images/100_hex.png" data-background-opacity="0.5" data-background-position="80% 50%" data-background-size="30%" class="quarto-title-block center">
  <h1 class="title">PSTAT 100: Lecture 19</h1>
  <p class="subtitle">Clustering; Introduction to Missing Data</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Ethan P. Marzban 
</div>
        <p class="quarto-title-affiliation">
            Department of Statistics and Applied Probability; UCSB <br> <br>
          </p>
        <p class="quarto-title-affiliation">
            Summer Session A, 2025
          </p>
    </div>
</div>

</section>
<section class="slide level2">

<p><span class="math display">\[
\newcommand\R{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Prob}{\mathbb{P}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\1}{1\!\!1}
\newcommand{\comp}[1]{#1^{\complement}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\SD}{\mathrm{SD}}
\newcommand{\vect}[1]{\vec{\boldsymbol{#1}}}
\newcommand{\tvect}[1]{\vec{\boldsymbol{#1}}^{\mathsf{T}}}
\newcommand{\hvect}[1]{\widehat{\boldsymbol{#1}}}
\newcommand{\mat}[1]{\mathbf{#1}}
\newcommand{\tmat}[1]{\mathbf{#1}^{\mathsf{T}}}
\newcommand{\Cov}{\mathrm{Cov}}
\DeclareMathOperator*{\argmin}{\mathrm{arg} \ \min}
\newcommand{\iid}{\stackrel{\mathrm{i.i.d.}}{\sim}}
\]</span></p>
<div class="cell">
<style type="text/css">
.hscroll {
  height: 100%;
  max-height: 600px;
  max-width: 2000px;
  overflow: scroll;
}

.hscroll2 {
  height: 100%;
  max-height: 300px;
  overflow: scroll;
}

.hscroll3 {
  max-width: 2rem;
  overflow: scroll;
}
</style>
</div>
</section>
<section id="congrats" class="slide level2">
<h2><i class="fa-solid fa-gift" aria-label="gift"></i> Congrats!</h2>
<ul>
<li class="fragment"><p>Congrats on finishing the last ICA!</p></li>
<li class="fragment"><p>Grades will be released shortly after lecture today - allow me to say a few words.</p></li>
<li class="fragment"><p>Also, looking forward: please don’t forget to continue to work on your Final Projects!</p></li>
</ul>
</section>
<section id="supervised-vs.-unspervised-learning" class="slide level2">
<h2><i class="fa-solid fa-braille" aria-label="braille"></i> Supervised Vs. Unspervised Learning</h2>
<ul>
<li class="fragment"><p>Though I haven’t made explicit mention about this yet, there exists a broad division of statistical learning into <span class="alert"><strong>supervised</strong></span> and <span class="alert"><strong>unsupervised</strong></span> learning.</p></li>
<li class="fragment"><p>Supervised learning is where we have a response variable, whose relationship with one or more covariates we are trying to <em>learn</em> (hence the name statistical “learning”)</p>
<ul>
<li class="fragment">Kernel Density Estimation, Regression, Classification, are both examples of supervised learning</li>
</ul></li>
<li class="fragment"><p>However, there are some situations in which we <em>don’t</em> have a response variable, and we are primarily interested in <em>summarising</em> or <em>understanding</em> our data. This is the setting of unsupervised learning.</p>
<ul>
<li class="fragment">One of the primary concepts from Week 2 of this course falls under this category - can anyone remind me what that concept is?</li>
</ul></li>
</ul>
</section>
<section id="clustering-vs.-classification" class="slide level2">
<h2><i class="fa-solid fa-braille" aria-label="braille"></i> Clustering vs.&nbsp;Classification</h2>
<ul>
<li class="fragment"><p>The first topic of today’s lecture, <span class="alert"><strong>clustering</strong></span>, is the unsupervised analog of classification.</p></li>
<li class="fragment"><p>As an example, consider the following scatterplot of penguins Bill Lengths plotted against their Body Mass:</p></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Lec19_files/figure-revealjs/unnamed-chunk-2-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment">Here’s a question: how many “groups” (clusters) of points do you see?
<ul>
<li class="fragment">Note that I’m not asking about the relationship between any two variables!</li>
</ul></li>
</ul>
</div></div>
</section>
<section id="clustering" class="slide level2">
<h2><i class="fa-solid fa-braille" aria-label="braille"></i> Clustering</h2>
<ul>
<li class="fragment"><p>By eye, it looks like there are potentially two main clusters.</p></li>
<li class="fragment"><p>But the boundaries between these clusters are perhaps a bit “fuzzy”.</p></li>
<li class="fragment"><p>For example, which group should the circled point belong to?</p></li>
</ul>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Lec19_files/figure-revealjs/unnamed-chunk-3-1.png" class="quarto-figure quarto-figure-center" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="clustering-1" class="slide level2">
<h2><i class="fa-solid fa-braille" aria-label="braille"></i> Clustering</h2>
<ul>
<li class="fragment">Essentially, the goal of clustering is to uncover patterns of “similarities” within the data.
<ul>
<li class="fragment">Such similarities can go a long way in interpreting and summarizing a given dataset.</li>
</ul></li>
</ul>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Question</strong></strong></p>
</div>
<div class="callout-content">
<p>Given <em>p</em> variables, can we classify observations into two or more groups?</p>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment"><p><span class="alert"><strong>Clustering Techniques</strong></span> seek to address this very question.</p></li>
<li class="fragment"><p>Now, to be clear, we are not making any impositions about whether or not true <em>subpopulations</em> exist.</p></li>
<li class="fragment"><p>It <em>is</em> possible that there exist subpopulations, like with the penguins dataset:</p></li>
</ul>
</section>
<section id="clustering-2" class="slide level2">
<h2><i class="fa-solid fa-braille" aria-label="braille"></i> Clustering</h2>
<h3 id="subpopulations-or-not">Subpopulations or Not</h3>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Lec19_files/figure-revealjs/unnamed-chunk-4-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>In this problem, there just so happened to exist three subpopulations in our data, and that this was what was driving our observations about clusters.</p></li>
<li class="fragment"><p>But clustering works just as well when there <em>aren’t</em> natural subpopulations in the data.</p></li>
</ul>
</div></div>
<ul>
<li class="fragment">For illustrative purposes, let’s stick with the penguins dataset and increase the number of variables we consider.</li>
</ul>
</section>
<section id="penguins-revisited" class="slide level2">
<h2><i class="fa-solid fa-kiwi-bird" aria-label="kiwi-bird"></i> Penguins, Revisited</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>penguins_num <span class="ot">&lt;-</span> penguins <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric))</span>
<span id="cb1-2"><a></a>penguins_num <span class="ot">&lt;-</span> penguins_num[penguins_num <span class="sc">%&gt;%</span> <span class="fu">complete.cases</span>(), ]</span>
<span id="cb1-3"><a></a>penguins_num <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">pander</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top" style="width:93%;">
<colgroup>
<col style="width: 23%">
<col style="width: 22%">
<col style="width: 27%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">bill_length_mm</th>
<th style="text-align: center;">bill_depth_mm</th>
<th style="text-align: center;">flipper_length_mm</th>
<th style="text-align: center;">body_mass_g</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">39.1</td>
<td style="text-align: center;">18.7</td>
<td style="text-align: center;">181</td>
<td style="text-align: center;">3750</td>
</tr>
<tr class="even">
<td style="text-align: center;">39.5</td>
<td style="text-align: center;">17.4</td>
<td style="text-align: center;">186</td>
<td style="text-align: center;">3800</td>
</tr>
<tr class="odd">
<td style="text-align: center;">40.3</td>
<td style="text-align: center;">18</td>
<td style="text-align: center;">195</td>
<td style="text-align: center;">3250</td>
</tr>
<tr class="even">
<td style="text-align: center;">36.7</td>
<td style="text-align: center;">19.3</td>
<td style="text-align: center;">193</td>
<td style="text-align: center;">3450</td>
</tr>
<tr class="odd">
<td style="text-align: center;">39.3</td>
<td style="text-align: center;">20.6</td>
<td style="text-align: center;">190</td>
<td style="text-align: center;">3650</td>
</tr>
<tr class="even">
<td style="text-align: center;">38.9</td>
<td style="text-align: center;">17.8</td>
<td style="text-align: center;">181</td>
<td style="text-align: center;">3625</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="penguins-revisited-1" class="slide level2">
<h2><i class="fa-solid fa-kiwi-bird" aria-label="kiwi-bird"></i> Penguins, Revisited</h2>
<h3 id="pca">PCA</h3>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">PC Plot</a></li><li><a href="#tabset-1-2">Species</a></li><li><a href="#tabset-1-3">Moral</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Lec19_files/figure-revealjs/unnamed-chunk-6-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Lec19_files/figure-revealjs/unnamed-chunk-7-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3">
<p>Even when there exist subpopulations, our clusters may not always reflect them (particularly if two or more subpopulations are very similar to one another).</p>
<p>In this way, we can perhaps think of clustering as identifying “inherent subpopulations” (like PCA uncovers “inherent dimensionality”)</p>
</div>
</div>
</div>
</section>
<section id="votes-revisited" class="slide level2">
<h2><i class="fa-solid fa-check-to-slot" aria-label="check-to-slot"></i> Votes, Revisited</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>votes <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="sc">%&gt;%</span> <span class="fu">pander</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top" style="width:100%;">
<colgroup>
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Rep</th>
<th style="text-align: center;">Party</th>
<th style="text-align: center;">State</th>
<th style="text-align: center;">H. R. 788</th>
<th style="text-align: center;">S. J. Res. 38</th>
<th style="text-align: center;">H. J. Res. 98</th>
<th style="text-align: center;">H. R. 6918</th>
<th style="text-align: center;">H. R. 6914</th>
<th style="text-align: center;">H. R. 5585</th>
<th style="text-align: center;">H. R. 6678</th>
<th style="text-align: center;">H. R. 6679</th>
<th style="text-align: center;">H. R. 6976</th>
<th style="text-align: center;">H. R. 485</th>
<th style="text-align: center;">H. R. 7176</th>
<th style="text-align: center;">H. R. 7511</th>
<th style="text-align: center;">H. R. 2799</th>
<th style="text-align: center;">H. R. 6276</th>
<th style="text-align: center;">H. R. 1121</th>
<th style="text-align: center;">H. R. 6009</th>
<th style="text-align: center;">H. R. 7023</th>
<th style="text-align: center;">H. R. 1023</th>
<th style="text-align: center;">H. R. 7888</th>
<th style="text-align: center;">H. R. 4639</th>
<th style="text-align: center;">H. R. 6046</th>
<th style="text-align: center;">H. R. 4691</th>
<th style="text-align: center;">H. R. 5947</th>
<th style="text-align: center;">H. R. 6323</th>
<th style="text-align: center;">H. R. 8038</th>
<th style="text-align: center;">H. R. 8036</th>
<th style="text-align: center;">H. R. 8035</th>
<th style="text-align: center;">H. R. 8034</th>
<th style="text-align: center;">H. R. 529</th>
<th style="text-align: center;">H. R. 3397</th>
<th style="text-align: center;">H. R. 615</th>
<th style="text-align: center;">H. R. 764</th>
<th style="text-align: center;">H. R. 3195</th>
<th style="text-align: center;">H. R. 6090</th>
<th style="text-align: center;">H. R. 6285</th>
<th style="text-align: center;">H. R. 6192</th>
<th style="text-align: center;">H. J. Res. 109</th>
<th style="text-align: center;">H. R. 2925</th>
<th style="text-align: center;">H. R. 7109</th>
<th style="text-align: center;">H. R. 7530</th>
<th style="text-align: center;">H. R. 7581</th>
<th style="text-align: center;">H. R. 7343</th>
<th style="text-align: center;">H. R. 354</th>
<th style="text-align: center;">H. R. 8146</th>
<th style="text-align: center;">H. R. 8369</th>
<th style="text-align: center;">H. R. 4763</th>
<th style="text-align: center;">H. R. 5403</th>
<th style="text-align: center;">H. R. 192</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Adams</td>
<td style="text-align: center;">Democratic</td>
<td style="text-align: center;">North Carolina</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">Aderholt</td>
<td style="text-align: center;">Republican</td>
<td style="text-align: center;">Alabama</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Aguilar</td>
<td style="text-align: center;">Democratic</td>
<td style="text-align: center;">California</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">Alford</td>
<td style="text-align: center;">Republican</td>
<td style="text-align: center;">Missouri</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Allen</td>
<td style="text-align: center;">Republican</td>
<td style="text-align: center;">Georgia</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">Allred</td>
<td style="text-align: center;">Democratic</td>
<td style="text-align: center;">Texas</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="votes-revisited-1" class="slide level2">
<h2><i class="fa-solid fa-check-to-slot" aria-label="check-to-slot"></i> Votes, Revisited</h2>

<img data-src="Lec19_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"><ul>
<li class="fragment">How many clusters? Two? Three?</li>
</ul>
</section>
<section id="votes-revisited-2" class="slide level2">
<h2><i class="fa-solid fa-check-to-slot" aria-label="check-to-slot"></i> Votes, Revisited</h2>
<h3 id="clustering-3">Clustering</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a>votes <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Party) <span class="sc">%&gt;%</span> <span class="fu">table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>.
   Democratic No data found    Republican 
          211             1           216 </code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Lec19_files/figure-revealjs/unnamed-chunk-13-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment">Let’s say we believe there to be two clusters in our data.</li>
<li class="fragment">Even with that determination, there is still the question of where to place our cluster boundaries.</li>
<li class="fragment">So, let’s discuss some techniques for setting those.</li>
</ul>
</div></div>
</section>
<section id="k-means-clustering" class="slide level2">
<h2><i class="fa-solid fa-circle-nodes" aria-label="circle-nodes"></i> <em>K</em>-Means Clustering</h2>
<ul>
<li class="fragment">One of the most widely-known clustering techniques is that of <span class="alert"><strong><em>K</em>-means</strong></span>.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment" style="text-align:center">
<p><img data-src="Images/cluster_centroids.svg" style="width:45.0%"></p>
<p>Identify the cluster <span class="alert"><strong>centroids</strong></span> by minimizing the variance within each cluster</p>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment" style="text-align:center">
<p><img data-src="Images/cluster_assignments.svg" style="width:45.0%"></p>
<p>Identify the cluster <span class="alert"><strong>assignments</strong></span> by finding the shortest Euclidean distance to a centroid</p>
</div>
</div></div>
</section>
<section id="k-means-clustering-1" class="slide level2">
<h2><i class="fa-solid fa-circle-nodes" aria-label="circle-nodes"></i> <em>K</em>-Means Clustering</h2>
<h3 id="optimization-problem">Optimization Problem</h3>
<ul>
<li class="fragment">Let <em>C</em><sub><em>i</em></sub> denote the indicies of points in cluster <em>i</em>, for <em>i</em> = 1, …, <em>K</em>, such that:
<ol type="1">
<li class="fragment"><span class="math inline">\(\bigcup_{i=1}^{K} C_i = \{1, \cdots, n\}\)</span> (each observation belongs to at least one of the <em>K</em> clusters)</li>
<li class="fragment"><span class="math inline">\(C_i \cap C_j = \varnothing\)</span> for all <span class="math inline">\(i \neq j\)</span> (clusters do not overlap)</li>
</ol></li>
<li class="fragment">A “good” clustering is one for which the <em>within-cluster variation</em> is as small as possible.</li>
</ul>
<div class="fragment" style="font-size:28px">
<p><span class="math display">\[\min_{C_1, \cdots, C_K} \left\{ \sum_{k=1}^{K} \frac{1}{|C_k|} \sum_{i, i' \in C_k} \sum_{j=1}^{p} (x_{ij} - x_{i' j})^2 \right\}\]</span></p>
</div>
</section>
<section id="k-means-clustering-2" class="slide level2">
<h2><i class="fa-solid fa-circle-nodes" aria-label="circle-nodes"></i> <em>K</em>-Means Clustering</h2>
<h3 id="optimization-problem-1">Optimization Problem</h3>
<ul>
<li class="fragment"><p>This optimization problem is, in general, intractable.</p></li>
<li class="fragment"><p>Thankfully, a local solution can be obtained using the following iterative algorithm (called the <span class="alert"><strong><em>K</em>-means clustering algorithm</strong></span>)</p></li>
</ul>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>K-Means Clustering Algorithm</strong></strong></p>
</div>
<div class="callout-content">
<ol type="1">
<li class="fragment">Start with a random initialization of clusters; i.e.&nbsp;assign a random number from {1, …, <em>K</em>} to each point</li>
<li class="fragment">Iterate the following until cluster assignments stop changing:
<ol type="a">
<li class="fragment">For each cluster, compute the cluster centroid</li>
<li class="fragment">Assign each observation to the cluster whose centroid is closest (in terms of Euclidean)</li>
</ol></li>
</ol>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment">This is iterative because after cluster assignments change, so too do the centroids.</li>
</ul>
</section>
<section id="k-means-clustering-3" class="slide level2">
<h2><i class="fa-solid fa-circle-nodes" aria-label="circle-nodes"></i> <em>K</em>-Means Clustering</h2>
<h3 id="votes-dataset">Votes Dataset</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" data-code-line-numbers="3,10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="fu">set.seed</span>(<span class="dv">100</span>)   <span class="do">## for reproducibility</span></span>
<span id="cb5-2"><a></a></span>
<span id="cb5-3"><a></a>km_votes <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(votes_num, <span class="at">centers =</span> <span class="dv">2</span>)</span>
<span id="cb5-4"><a></a><span class="fu">prcomp</span>(votes_num, <span class="at">scale. =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a></a>  <span class="fu">mutate</span>(<span class="at">kmeans_clust =</span> <span class="fu">factor</span>(km_votes<span class="sc">$</span>cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2)) <span class="sc">+</span></span>
<span id="cb5-8"><a></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb5-9"><a></a>             <span class="fu">aes</span>(<span class="at">col =</span> kmeans_clust)) <span class="sc">+</span></span>
<span id="cb5-10"><a></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">18</span>) <span class="sc">+</span></span>
<span id="cb5-11"><a></a>  <span class="fu">ggtitle</span>(<span class="st">"PCA Plot of Votes Dataset"</span>,</span>
<span id="cb5-12"><a></a>          <span class="at">subtitle =</span> <span class="st">"Clustered using K-Means"</span>) <span class="sc">+</span></span>
<span id="cb5-13"><a></a>  <span class="fu">scale_color_okabe_ito</span>() <span class="sc">+</span></span>
<span id="cb5-14"><a></a>  <span class="fu">labs</span>(<span class="at">col =</span> <span class="st">"Cluster"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="Lec19_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section id="k-means-clustering-4" class="slide level2" style="font-size:30px">
<h2><i class="fa-solid fa-circle-nodes" aria-label="circle-nodes"></i> <em>K</em>-Means Clustering</h2>
<h3 id="votes-dataset-1">Votes Dataset</h3>
<ul>
<li class="fragment">Since we believe there to be some clustering along party lines, we can cross-tabulate the cluster labels with party labels:</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top" style="width:72%;">
<colgroup>
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 22%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">cluster</th>
<th style="text-align: center;">Democratic</th>
<th style="text-align: center;">No data found</th>
<th style="text-align: center;">Republican</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">207</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">NA</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">216</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<ul>
<li class="fragment">Interestingly, this reveals that there are four democratic representatives that appear to vote more similarly to republicans than democrats</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<table class="caption-top" style="width:61%;">
<colgroup>
<col style="width: 19%">
<col style="width: 18%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Rep</th>
<th style="text-align: center;">Party</th>
<th style="text-align: center;">State</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Cuellar</td>
<td style="text-align: center;">Democratic</td>
<td style="text-align: center;">Texas</td>
</tr>
<tr class="even">
<td style="text-align: center;">Davis (NC)</td>
<td style="text-align: center;">Democratic</td>
<td style="text-align: center;">North Carolina</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Golden (ME)</td>
<td style="text-align: center;">Democratic</td>
<td style="text-align: center;">Maine</td>
</tr>
<tr class="even">
<td style="text-align: center;">Perez</td>
<td style="text-align: center;">Democratic</td>
<td style="text-align: center;">Washington</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="k-means-clustering-5" class="slide level2" style="font-size:30px">
<h2><i class="fa-solid fa-circle-nodes" aria-label="circle-nodes"></i> <em>K</em>-Means Clustering</h2>
<h3 id="votes-dataset-2">Votes Dataset</h3>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Images/perez.png" style="width:60.0%"></p>
<figcaption><strong>Source:</strong> https://www.politico.com/minutes/congress/05-24-2023/blue-dog-boost-centrists-house/</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Images/cuellar.png" style="width:60.0%"></p>
<figcaption><strong>Source:</strong> https://en.wikipedia.org/wiki/Henry_Cuellar</figcaption>
</figure>
</div>
</section>
<section id="k-means-clustering-6" class="slide level2" style="font-size:30px">
<h2><i class="fa-solid fa-circle-nodes" aria-label="circle-nodes"></i> <em>K</em>-Means Clustering</h2>
<h3 id="votes-dataset-3">Votes Dataset</h3>
<ul>
<li class="fragment">Also, we can examine the one person whose party affiliation is missing from the original dataset:</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Lec19_files/figure-revealjs/unnamed-chunk-17-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment"><p>This person falls well within our “Democratcic” cluster, meaning they are likely a Democrat.</p></li>
<li class="fragment"><p>In this way, we can see that clustering can, in some cases, help us with <span class="alert"><strong>missing data</strong></span>.</p></li>
<li class="fragment"><p>Indeed, perhaps this is a good segue into our next topic for today…</p></li>
</ul>
</div></div>
</section>
<section>
<section id="missing-data" class="title-slide slide level1 center" data-background-color="black" data-background-image="https://media3.giphy.com/media/v1.Y2lkPTc5MGI3NjExMGczeHV6amRxNWtoNW1penZkeGttNWIwMzhoZThpazRzbms3aGVnZyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Ru9sjtZ09XOEg/200.gif" data-background-size="60rem">
<h1>Missing Data</h1>

</section>
<section id="missing-data-1" class="slide level2">
<h2><i class="fa-solid fa-notdef" aria-label="notdef"></i> Missing Data</h2>
<ul>
<li class="fragment"><p><span class="alert"><strong>Missing data</strong></span> occurs when one or more variables have observations that are not present.</p></li>
<li class="fragment"><p>There are a variety of reasons why data might be missing:</p>
<ul>
<li class="fragment">equipment failure</li>
<li class="fragment">non-response bias</li>
<li class="fragment">sample corruption</li>
<li class="fragment">atrition (participants dropping out)</li>
</ul></li>
<li class="fragment"><p>Missing values are often encoded using a special symbol. In <code>R</code>, missing values are by default mapped to the symbol <code>NA</code>.</p></li>
<li class="fragment"><p>Admittedly, missing data is the bane of most data scientists’ existences.</p></li>
</ul>
</section>
<section id="missing-data-2" class="slide level2">
<h2><i class="fa-solid fa-notdef" aria-label="notdef"></i> Missing Data</h2>
<ul>
<li class="fragment">For example, many functions in <code>R</code> break down in the presence of missing data</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb6-2"><a></a><span class="fu">mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">Some functions have the ability to ignore missing values, often through the specification of an additional argument:</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb8-2"><a></a><span class="fu">mean</span>(x, <span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong><strong>Caution</strong></strong></p>
</div>
<div class="callout-content">
<p>Simply throwing out missing values is, in some cases, ill-advised.</p>
</div>
</div>
</div>
</div>
</section>
<section id="missing-data-3" class="slide level2">
<h2><i class="fa-solid fa-notdef" aria-label="notdef"></i> Missing Data</h2>
<ul>
<li class="fragment"><p>So how <em>should</em> missing values be handled in practice?</p></li>
<li class="fragment"><p>This is a <em>very</em> hot-topic question!</p>
<ul>
<li class="fragment">Indeed, today’s lecture isn’t meant to be a comprehensive guide on handling missingness; rather, I’d encourage you to treat this as an exercise in raising awareness.</li>
<li class="fragment">The text <a href="https://stefvanbuuren.name/fimd/"><em>Flexible Imputation of Missing Data</em> by Stef Van Buuren</a> provides a great introduction to the topic of handling missing data.</li>
</ul></li>
<li class="fragment"><p>The general idea is that we need to consider the <em>mechanisms</em> behind the missingness.</p></li>
</ul>
</section>
<section id="missing-data-4" class="slide level2">
<h2><i class="fa-solid fa-notdef" aria-label="notdef"></i> Missing Data</h2>
<h3 id="general-framework">General Framework</h3>
<ul>
<li class="fragment"><p>Let <span class="math inline">\(X = \{x_{ij}\}_{(i, j) = (1, 1)}^{(n, p)}\)</span> denote an <span class="math inline">\(n \times p\)</span> dataset (i.e.&nbsp;a dataset with <em>n</em> observations on <em>p</em> variables).</p></li>
<li class="fragment"><p>Denote by <span class="math inline">\(q_{ij}\)</span> the probability that element <span class="math inline">\(x_{ij}\)</span> is missing: <span class="math display">\[ q_{ij} := \Prob(x_{ij} \text{ is missing}) \]</span></p></li>
<li class="fragment"><p>There are two main cases to consider: one where data is <span class="alert"><strong>Missing Completely at Random</strong></span> (MCAR) and on where data is <span class="alert"><strong>Missing at Random</strong></span> (MAR).</p></li>
</ul>
</section>
<section id="missing-data-5" class="slide level2">
<h2><i class="fa-solid fa-notdef" aria-label="notdef"></i> Missing Data</h2>
<h3 id="mcar-vs-mar">MCAR vs MAR</h3>
<ul>
<li class="fragment">If data is MCAR, then <span class="math inline">\(q_{ij}\)</span> is fixed across all <em>i</em> and <em>j</em>.
<ul>
<li class="fragment">That is, every element in <em>X</em> has an equal chance of being missing.</li>
<li class="fragment">This implies that the cause of missingness is <em>unrelated to the data</em>.</li>
<li class="fragment">As such, missing values <em>can be safely ignored</em>.</li>
</ul></li>
<li class="fragment">If data is MAR, then <span class="math inline">\(q_{ij}\)</span> is some function of observed data: <span class="math inline">\(q_{ij} = f(\vec{\boldsymbol{x}}_{i})\)</span>.
<ul>
<li class="fragment">Now, the cause of missingness <em>is</em> related to the data, and simply ignoring missing values can lead to potentially <em>biased</em> results.</li>
<li class="fragment">It is, however, possible to <em>estimate</em> the probabilities <span class="math inline">\(q_{ij}\)</span>, since they depend only on <em>observed</em> data.</li>
</ul></li>
</ul>
</section>
<section id="missing-data-6" class="slide level2" style="font-size:30px">
<h2><i class="fa-solid fa-notdef" aria-label="notdef"></i> Missing Data</h2>
<h3 id="mnar">MNAR</h3>
<ul>
<li class="fragment"><p>We can see that MCAR is perhaps the “best-case” scenario.</p></li>
<li class="fragment"><p>With that interpretation, the “worst-case” scenario is when data is <span class="alert"><strong>Missing Not at Random</strong></span> (MNAR).</p></li>
<li class="fragment"><p>If data is MNAR, then the probabilities <span class="math inline">\(q_{ij}\)</span> depend on both observed values and <em>unobserved</em> values as well: <span class="math inline">\(q_{ij} = f(z_i, x_{ij})\)</span> for unknown <span class="math inline">\(z_j\)</span>.</p>
<ul>
<li class="fragment">Now, not only is the missigness related to the data (like when data is MNAR), it is <em>impossible</em> to estimate the <span class="math inline">\(q_{ij}\)</span> as they depend on <em>unobserved</em> quantities.</li>
</ul></li>
<li class="fragment"><p>Unfortunately, there aren’t any formal tests to determine whether data is MCAR, MAR, or MNAR; the best (and only) way to determine the missingness mechanism is to make an informed assumption based on knowledge about the data collection procedure (which is why we started off today by talking about sampling!)</p></li>
</ul>
</section>
<section id="missing-data-7" class="slide level2">
<h2><i class="fa-solid fa-notdef" aria-label="notdef"></i> Missing Data</h2>
<h3 id="example">Example</h3>
<ul>
<li class="fragment"><p>Here is an example to illustrate the difference between some of these mechanisms, adapted from the article <a href="https://academic.oup.com/ije/article/43/4/1336/2938944"><em>What is the difference between missing completely at random and missing at random?</em> by Krishnan Bhaskaran and Liam Smeeth</a></p></li>
<li class="fragment"><p>Suppose we have a dataset containing several patients’ blood pressures.</p></li>
<li class="fragment"><p>Some values are missing.</p>
<ul>
<li class="fragment">Indeed, healthy persons are likely going to the doctor less often than, say, eldery persons and people with preexisting conditions, meaning there are more observations from this latter group of people.</li>
<li class="fragment">In fact, it is very likely that, on average, blood pressures are higher in this latter group than in the former group (of healthy individuals).</li>
</ul></li>
</ul>
</section>
<section id="missing-data-8" class="slide level2">
<h2><i class="fa-solid fa-notdef" aria-label="notdef"></i> Missing Data</h2>
<h3 id="example-1">Example</h3>
<ul>
<li class="fragment"><p>So, if we looked at an (imaginary) histogram of the missing blood pressure values, this histogram would likely be right-shifted when compared to a histogram of the non-missing values.</p></li>
<li class="fragment"><p>If the data were missing MCAR, these two histograms would be the same.</p>
<ul>
<li class="fragment">The histograms are likely <em>not</em> the same, so the data is likely not MCAR.</li>
</ul></li>
<li class="fragment"><p>However, we can <em>explain</em> any differences between the (hypothetical) missing values and the non-missing values using <em>observable</em> quantities (e.g.&nbsp;preexisting health conditions, age, etc.)</p>
<ul>
<li class="fragment">So, the data is likely MAR.</li>
</ul></li>
</ul>
</section>
<section id="missing-data-9" class="slide level2">
<h2><i class="fa-solid fa-notdef" aria-label="notdef"></i> Missing Data</h2>
<h3 id="what-to-do">What To Do?</h3>
<ul>
<li class="fragment"><p>Alright, let’s say we have data that is MCAR or MAR. What do we do?</p></li>
<li class="fragment"><p>Again, one option is to simply drop the missing values (e.g.&nbsp;using <code>tidyr::drop_na()</code>, or <code>complete.cases()</code>).</p>
<ul>
<li class="fragment">This “works” if data is MCAR, but is risky if data is MAR.</li>
</ul></li>
<li class="fragment"><p>Another option is <span class="alert"><strong>imputation</strong></span>, which, broadly speaking, refers to the act of trying to “fill in” the missing values in some way.</p>
<ul>
<li class="fragment">If data is MAR or MNAR, this will often induce bias, so, again, it’s important to assess what type of missingness you believe is present before deciding to impute.</li>
</ul></li>
</ul>
</section>
<section id="missing-data-10" class="slide level2">
<h2><i class="fa-solid fa-notdef" aria-label="notdef"></i> Missing Data</h2>
<h3 id="imputation">Imputation</h3>
<ul>
<li class="fragment"><p>One idea is to replace the missing value with the mean/median of the surrounding non-missing values (sometimes called <span class="alert"><strong>mean imputation</strong></span>).</p></li>
<li class="fragment"><p>Another imputation technique is to try and <em>predict</em> the missing value from other recorded values in the dataset (sometimes called <span class="alert"><strong>model-based imputation</strong></span>).</p></li>
<li class="fragment"><p>If data is MCAR or MAR, we can try to explicitly model the probability of missingness, and apply bias corrections (like the inverse probability weighting scheme we saw on Lab 4).</p></li>
</ul>
</section>
<section id="missing-data-11" class="slide level2">
<h2><i class="fa-solid fa-notdef" aria-label="notdef"></i> Missing Data</h2>
<h3 id="dos-and-donts">Do’s and Dont’s</h3>
<p><strong>Do:</strong></p>
<ul>
<li class="fragment">Start by checking for missing values right after importing your data
<ul>
<li class="fragment">Tabulate the proportion of missing values</li>
</ul></li>
<li class="fragment">Take steps to determine the missigness mechanisms (MCAR, MAR, or MNAR)</li>
</ul>
<div class="fragment">
<p><strong>Don’t:</strong></p>
</div>
<ul>
<li class="fragment">Rely on software defaults for handling missing values</li>
<li class="fragment">Drop missing values if data is not MCAR, or if there is too high a proportion of missing values</li>
</ul>
</section>
<section id="next-time" class="slide level2">
<h2><i class="fa-solid fa-forward-fast" aria-label="forward-fast"></i> Next Time</h2>
<ul>
<li class="fragment"><p>Tomorrow, we’ll start talking a bit about Neural Networks.</p></li>
<li class="fragment"><p>In Lab tomorrow, you’ll get some practice with clustering and missing data.</p></li>
<li class="fragment"><p>Reminder: keep working on your projects!</p></li>
</ul>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="Images/100_hex.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>PSTAT 100 - Data Science: Concepts and Analysis, Summer 2025 with Ethan P. Marzban</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
            let selectedAnnoteEl;
            const selectorForAnnotation = ( cell, annotation) => {
              let cellAttr = 'data-code-cell="' + cell + '"';
              let lineAttr = 'data-code-annotation="' +  annotation + '"';
              const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
              return selector;
            }
            const selectCodeLines = (annoteEl) => {
              const doc = window.document;
              const targetCell = annoteEl.getAttribute("data-target-cell");
              const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
              const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              const lines = annoteSpan.getAttribute("data-code-lines").split(",");
              const lineIds = lines.map((line) => {
                return targetCell + "-" + line;
              })
              let top = null;
              let height = null;
              let parent = null;
              if (lineIds.length > 0) {
                  //compute the position of the single el (top and bottom and make a div)
                  const el = window.document.getElementById(lineIds[0]);
                  top = el.offsetTop;
                  height = el.offsetHeight;
                  parent = el.parentElement.parentElement;
                if (lineIds.length > 1) {
                  const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                  const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                  height = bottom - top;
                }
                if (top !== null && height !== null && parent !== null) {
                  // cook up a div (if necessary) and position it 
                  let div = window.document.getElementById("code-annotation-line-highlight");
                  if (div === null) {
                    div = window.document.createElement("div");
                    div.setAttribute("id", "code-annotation-line-highlight");
                    div.style.position = 'absolute';
                    parent.appendChild(div);
                  }
                  div.style.top = top - 2 + "px";
                  div.style.height = height + 4 + "px";
                  div.style.left = 0;
                  let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                  if (gutterDiv === null) {
                    gutterDiv = window.document.createElement("div");
                    gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                    gutterDiv.style.position = 'absolute';
                    const codeCell = window.document.getElementById(targetCell);
                    const gutter = codeCell.querySelector('.code-annotation-gutter');
                    gutter.appendChild(gutterDiv);
                  }
                  gutterDiv.style.top = top - 2 + "px";
                  gutterDiv.style.height = height + 4 + "px";
                }
                selectedAnnoteEl = annoteEl;
              }
            };
            const unselectCodeLines = () => {
              const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
              elementsIds.forEach((elId) => {
                const div = window.document.getElementById(elId);
                if (div) {
                  div.remove();
                }
              });
              selectedAnnoteEl = undefined;
            };
              // Handle positioning of the toggle
          window.addEventListener(
            "resize",
            throttle(() => {
              elRect = undefined;
              if (selectedAnnoteEl) {
                selectCodeLines(selectedAnnoteEl);
              }
            }, 10)
          );
          function throttle(fn, ms) {
          let throttle = false;
          let timer;
            return (...args) => {
              if(!throttle) { // first call gets through
                  fn.apply(this, args);
                  throttle = true;
              } else { // all the others get throttled
                  if(timer) clearTimeout(timer); // cancel #2
                  timer = setTimeout(() => {
                    fn.apply(this, args);
                    timer = throttle = false;
                  }, ms);
              }
            };
          }
            const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
            for (let i=0; i<annoteTargets.length; i++) {
              const annoteTarget = annoteTargets[i];
              const targetCell = annoteTarget.getAttribute("data-target-cell");
              const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
              const contentFn = () => {
                const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
                if (content) {
                  const tipContent = content.cloneNode(true);
                  tipContent.classList.add("code-annotation-tip-content");
                  return tipContent.outerHTML;
                }
              }
              const config = {
                allowHTML: true,
                content: contentFn,
                onShow: (instance) => {
                  selectCodeLines(instance.reference);
                  instance.reference.classList.add('code-annotation-active');
                  window.tippy.hideAll();
                },
                onHide: (instance) => {
                  unselectCodeLines();
                  instance.reference.classList.remove('code-annotation-active');
                },
                maxWidth: 300,
                delay: [50, 0],
                duration: [200, 0],
                offset: [5, 10],
                arrow: true,
                appendTo: function(el) {
                  return el.parentElement.parentElement.parentElement;
                },
                interactive: true,
                interactiveBorder: 10,
                theme: 'light-border',
                placement: 'right',
                popperOptions: {
                  modifiers: [
                  {
                    name: 'flip',
                    options: {
                      flipVariations: false, // true by default
                      allowedAutoPlacements: ['right'],
                      fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                    },
                  },
                  {
                    name: 'preventOverflow',
                    options: {
                      mainAxis: false,
                      altAxis: false
                    }
                  }
                  ]        
                }      
              };
              window.tippy(annoteTarget, config); 
            }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>